<?php

$(macro :unsafe) {
    __json_serializable_methods()
} >> {
    public function jsonSerialize(): array
    {
        $result = [];
        $elementCount = $this->elementCount;
        for ($getIteratorIndex = 0; $getIteratorIndex < $elementCount; ++$getIteratorIndex) {
            $$(expand(
                $$(expand(__get_value($this, primary, $getIteratorIndex, $element)))
            ));
            $result[] = $element;
        }
        return $result;
    }
}